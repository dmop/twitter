var cda = {
    "metadata": [{
        "colName": "Categoria",
        "colType": "String",
        "colIndex": 0
    }, {
        "colName": "CatName",
        "colType": "String",
        "colIndex": 1
    }, {
        "colName": "Faturamento",
        "colType": "Numeric",
        "colIndex": 2
    }, {
        "colName": "Margem",
        "colType": "Numeric",
        "colIndex": 3
    }, {
        "colName": "Meta",
        "colType": "String",
        "colIndex": 4
    }, {
        "colName": "perc_meta",
        "colType": "String",
        "colIndex": 5
    }, {
        "colName": "Faturamento (M-1)",
        "colType": "Numeric",
        "colIndex": 6
    }, {
        "colName": "Margem (M-1)",
        "colType": "Numeric",
        "colIndex": 7
    }, {
        "colName": "Faturamento (A-1)",
        "colType": "Numeric",
        "colIndex": 8
    }, {
        "colName": "Margem (A-1)",
        "colType": "Numeric",
        "colIndex": 9
    }, {
        "colName": "Tendencia",
        "colType": "Numeric",
        "colIndex": 10
    }, {
        "colName": "perc_tendencia",
        "colType": "String",
        "colIndex": 11
    }],
    "resultset": [
        ["[Categoria].[HIGIENE PESSOAL A BELEZA]", 1918705.7299999997, 0.08542748049773541, null, null, 2823762.89, 0.09100725487608906, 2228014.349999999, 0.04790013517543379, 2398382.1624999996, null],

        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO]", 1918705.7299999997, 0.08542748049773541, null, null, 2823762.89, 0.09100725487608906, 2228014.349999999, 0.04790013517543379, 2398382.1624999996, null],

        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR]", 1918705.7299999997, 0.08542748049773541, null, null, 2823762.89, 0.09100725487608906, 2228014.349999999, 0.04790013517543379, 2398382.1624999996, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[MANICURE E PEDICURE]", 239841.08000000002, 0.09548631930766024, null, null, 542772.8600000001, 0.09500029971565722, 142898.25, 0.03361218941878755, 299801.35, null],

        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[LIMPEZA GERAL]", 724086.1499999999, 0.09046073611648317, null, null, 727492.07, 0.07431187693434106, 599639.4, 0.053239320104506625, 905107.6874999999, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[LIMPEZA GERAL].[DESOD SANITARIO]", 723492.8500000001, 0.09137272377070838, null, null, 726582.6600000001, 0.07473358292364922, 599639.4, 0.053239320104506625, 904366.0625, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[LIMPEZA GERAL].[CERA SAPATO]", 593.3000000000002, 0.055864469195510136, null, null, 909.41, 0.058379899607087005, null, null, 741.6250000000002, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[PROTETOR LABIAL]", 1089354.0699999998, 0.0811069987436815, null, null, 1546040.66, 0.11044832687409521, 852771.0099999998, 0.060613883840316296, 1361692.5874999997, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[PROTETOR LABIAL].[BAZAR]", 1089354.0699999998, 0.0811069987436815, null, null, 1546040.66, 0.11044832687409521, 852771.0099999998, 0.060613883840316296, 1361692.5874999997, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[PROTETOR LABIAL].[BAZAR].[FILMES]", 1077663.6899999997, -0.01855712607013228, null, null, 1524866.7000000002, 0.00922105607286479, 848565.8799999999, 0.020204289687113096, 1347079.6124999998, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[PROTETOR LABIAL].[BAZAR].[GUARDANAPOS]", 10623.76, 0.1502115234592813, null, null, 19358.94, 0.17709370213140527, 4205.130000000001, 0.1156921963428948, 13279.699999999999, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[PROTETOR SOLAR]", 105265.51, 0.08902808925919226, null, null, 550230.1599999999, 0.04062507599809306, 775603.94, 0.009052181839442298, 131581.88749999998, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[LINHA SOLAR].[PROTETOR SOLAR].[BELEZA&SAUDE]", 105265.51, 0.08902808925919226, null, null, 550230.1599999999, 0.04062507599809306, 775603.94, 0.009052181839442298, 131581.88749999998, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[MANICURE E PEDICURE].[CUTELARIA]", 239841.08000000002, 0.09548631930766024, null, null, 542772.8600000001, 0.09500029971565722, 142898.25, 0.03361218941878755, 299801.35, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[MANICURE E PEDICURE].[CUTELARIA].[BISCOITOS]", 226382.97000000003, 0.0012824364804562417, null, null, 529366.8899999999, 0.025946857868171472, 138094.26, -0.02257638503191322, 282978.7125, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[MANICURE E PEDICURE].[CUTELARIA].[BISCOITOS].[SECOS&DOCES]", 226382.97000000003, 0.0012824364804562417, null, null, 529366.8899999999, 0.025946857868171472, 138094.26, -0.02257638503191322, 282978.7125, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[MANICURE E PEDICURE].[ESMALTE]", 13458.109999999995, 0.1331724266371162, null, null, 13405.970000000003, 0.13191617483045082, 4803.989999999999, 0.05616940596961455, 16822.637499999993, null],
        ["[Categoria].[HIGIENE PESSOAL A BELEZA].[CORPO].[MANICURE E PEDICURE].[ESMALTE].[MOLHOS]", 13458.109999999995, 0.1331724266371162, null, null, 13405.970000000003, 0.13191617483045082, 4803.989999999999, 0.05616940596961455, 16822.637499999993, null],

        ["[Categoria].[LIMPEZA]", 1918705.7299999997, 0.08542748049773541, null, null, 2823762.89, 0.09100725487608906, 2228014.349999999, 0.04790013517543379, 2398382.1624999996, null],
        ["[Categoria].[MAGAZINE]", 277961.71, 0.10497190801022864, null, null, 608728.8499999999, 0.09929198088482467, 194426.70000000004, 0.06264972256820278, 347452.1375, null],
        ["[Categoria].[MAGAZINE].[ARTIGOS ESPORTE]", 38120.630000000005, 0.11940871878992565, null, null, 65955.99, 0.10455589304208698, 51528.44999999999, 0.08405786352537825, 47650.787500000006, null],
        ["[Categoria].[MAGAZINE].[ARTIGOS ESPORTE].[BOLAS]", 38120.630000000005, 0.11940871878992565, null, null, 65955.99, 0.10455589304208698, 51528.44999999999, 0.08405786352537825, 47650.787500000006, null],

        ["[Categoria].[NESTLE ALIMENTOS]", 113199.60000000003, 0.13747518896146974, null, null, 125715.93, 0.14504354457500573, 184040.57, 0.11247543352552049, 141499.50000000003, null],
        ["[Categoria].[NESTLE ALIMENTOS].[CHOCOLATES]", 25811.36, 0.13461212287814098, null, null, 29203.45, 0.13566992833907232, 25785.39, 0.04248867402535556, 32264.2, null],
        ["[Categoria].[NESTLE ALIMENTOS].[CHOCOLATES].[CEREAL BARRA]", 25811.36, 0.13461212287814098, null, null, 29203.45, 0.13566992833907232, 25785.39, 0.04248867402535556, 32264.2, null],
        ["[Categoria].[NESTLE ALIMENTOS].[ACHOCOLATADOS POS]", 113199.60000000003, 0.13747518896146974, null, null, 125715.93, 0.14504354457500573, 184040.57, 0.11247543352552049, 141499.50000000003, null],
        ["[Categoria].[NESTLE ALIMENTOS].[ACHOCOLATADOS POS].[ACHOC PO LATA 400G]", 113199.60000000003, 0.13747518896146974, null, null, 125715.93, 0.14504354457500573, 184040.57, 0.11247543352552049, 141499.50000000003, null],
        ["[Categoria].[NESTLE ALIMENTOS].[SUCOS EM PO]", 49432.42000000002, 0.12785433180904018, null, null, 59689.090000000004, 0.11009572359883388, 44405.56999999999, 0.14922625418395039, 61790.52500000002, null],
        ["[Categoria].[NESTLE ALIMENTOS].[SUCOS EM PO].[SUCOS EM PO]", 49432.42000000002, 0.12785433180904018, null, null, 59689.090000000004, 0.11009572359883388, 44405.56999999999, 0.14922625418395039, 61790.52500000002, null],
        ["[Categoria].[NESTLE ALIMENTOS].[PESSEGO]", 1066.62, 0.14235467879146657, null, null, 1815.02, 0.12299082415047705, null, null, 1333.2749999999999, null],

        ["[Categoria].[DEL]", 8716.020000000002, 0.1504218436415266, null, null, 13035.289999999999, 0.13573143642178423, null, null, 10895.025000000003, null],
        ["[Categoria].[DEL].[DEL]", 8716.020000000002, 0.1504218436415266, null, null, 13035.289999999999, 0.13573143642178423, null, null, 10895.025000000003, null],
        ["[Categoria].[BRINDES]", 49432.42000000002, 0.12785433180904018, null, null, 59689.090000000004, 0.11009572359883388, 44405.56999999999, 0.14922625418395039, 61790.52500000002, null],
        ["[Categoria].[DEVOLUCAO]", 202217.77000000002, 0.12015464213139361, null, null, 198526.81999999998, 0.12045475049279374, 385782.7799999999, 0.08803576707976284, 252772.21250000002, null],
        ["[Categoria].[DEVOLUCAO].[LACTEOS]", 202217.77000000002, 0.12015464213139361, null, null, 198526.81999999998, 0.12045475049279374, 385782.7799999999, 0.08803576707976282, 252772.21250000002, null]
    ],
    "queryInfo": {
        "totalRows": "33"
    }
};


function toTree(data){
  var obj = {},
      nId = 0,      // name index
      currId = 1;

    for( var x = 0 ; x < data.length ; x++ ){
      var name = data[x][nId],
          firstDiv = name.indexOf("].[")+2,
          lastDiv = name.lastIndexOf("].["),
          uniqueName = name.substring(firstDiv),
          parent = name.substring(firstDiv,lastDiv+1),
          isRoot = parent === ".",
          label = name.substring(lastDiv+3, name.length-1);

          obj[uniqueName] = {
            isRoot : isRoot,
            label : label,
            parent : parent,
            id : "treegrid-"+currId
          };
          currId++;


    }
    console.log(JSON.stringify(obj,null, 4));

}

toTree(cda.resultset);
